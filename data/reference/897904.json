[
    {
        "link": "https://ablebits.com/office-addins-blog/vlookup-multiple-sheets-excel-examples",
        "document": "The tutorial shows how to use the VLOOKUP function to copy data from another worksheet or workbook, Vlookup in multiple sheets, and look up dynamically to return values from different sheets into different cells.\n\nWhen looking up some information in Excel, it's a rare case when all the data is on the same sheet. More often, you will have to search across multiple sheets or even different workbooks. The good news is that Microsoft Excel provides more than one way to do this, and the bad news is that all the ways are a bit more complicated than a standard VLOOKUP formula. But with just a little patience, we will figure them out :)\n\nHow to VLOOKUP between two sheets For starters, let's investigate a simplest case - using VLOOKUP to copy data from another worksheet. It's very similar to a regular VLOOKUP formula that searches on the same worksheet. The difference is that you include the sheet name in the table_array argument to tell your formula in which worksheet the lookup range is located. The generic formula to VLOOKUP from another sheet is as follows: As an example, let's pull the sales figures from Jan report to Summary sheet. For this, we define the following arguments:\n• Lookup_values are in column A on the Summary sheet, and we refer to the first data cell, which is A2.\n• Table_array is the range A2:B6 on the Jan sheet. To refer to it, prefix the range reference with the sheet name followed by the exclamation point: Jan!$A$2:$B$6. Please pay attention that we lock the range with absolute cell references to prevent it from changing when copying the formula to other cells.\n\n Col_index_num is 2 because we want to copy a value from column B, which is the 2nd column in the table array.\n• Range_lookup is set to FALSE to look up an exact match. Putting the arguments together, we get this formula: Drag the formula down the column and you will get this result: In a similar manner, you can Vlookup data from the Feb and Mar sheets:\n• If the sheet name contains spaces or non-alphabetical characters, it must be enclosed in single quotation marks, like 'Jan Sales'!$A$2:$B$6. For more info, please see How to reference another sheet in Excel.\n• Instead of typing a sheet name directly in a formula, you can switch to the lookup worksheet and select the range there. Excel will insert a reference with the correct syntax automatically, sparing you the trouble to check the name and troubleshoot.\n\nWhen you need to look up between more than two sheets, the easiest solution is to use VLOOKUP in combination with IFERROR. The idea is to nest several IFERROR functions to check multiple worksheets one by one: if the first VLOOKUP does not find a match on the first sheet, search in the next sheet, and so on. To see how this approach works on real-life data, let's consider the following example. Below is the Summary table that we want to populate with the item names and amounts by looking up the order number in West and East sheets: First, we are going to pull the items. For this, we instruct the VLOOKUP formula to search for the order number in A2 on the East sheet and return the value from column B (2nd column in table_array A2:C6). If an exact match is not found, then search in the West sheet. If both Vlookups fail, return \"Not found\". To return the amount, simply change the column index number to 3: Tip. If needed, you can specify different table arrays for different VLOOKUP functions. In this example, both lookup sheets have the same number of rows (A2:C6), but your worksheets may be different in size. To Vlookup between two or more workbooks, enclose the workbook name in square brackets and put it before the sheet name. For example, here's how you can Vlookup in two different files (Book1 and Book2) with a single formula: In situation when you need to return data from several columns, making col_index_num dynamic could save you some time. There are a couple of adjustments to be made:\n• For the col_index_num argument, use the COLUMNS function that returns the number of columns in a specified array: COLUMNS($A$1:B$1). (The row coordinate does not really matter, it can be just any row.)\n• In the lookup_value argument, lock the column reference with the $ sign ($A2), so it remains fixed when copying the formula to other columns. As the result, you get a kind of dynamic formula that extracts matching values from different columns, depending on which column the formula is copied to: When entered in column B, COLUMNS($A$1:B$1) evaluates to 2 telling VLOOKUP to return a value from the 2nd column in the table array. When copied to column C (i.e. you've dragged the formula from B2 to C2), B$1 changes to C$1 because the column reference is relative. Consequently, COLUMNS($A$1:C$1) evaluates to 3 forcing VLOOKUP to return a value from the 3rd column. This formula works great for 2 - 3 lookup sheets. If you have more, repetitive IFERRORs become too cumbersome. The next example demonstrates a bit more complicated but a lot more elegant approach.\n\n\n\nOne more way to Vlookup between multiple sheets in Excel is to use a combination of VLOOKUP and INDIRECT functions. This method requires a little preparation, but in the end, you will have a more compact formula to Vlookup in any number of spreadsheets. A generic formula to Vlookup across sheets is as follows:\n• Lookup_value - the value to search for.\n• Lookup_range - the column range in the lookup sheets where to search for the lookup value.\n• Table_array - the data range in the lookup sheets.\n• Col_index_num - the number of the column in the table array from which to return a value. For the formula to work correctly, please bear in mind the following caveats:\n• It's an array formula, which must be completed by pressing keys together.\n• All the sheets must have the same order of columns.\n• As we use one table array for all lookup sheets, specify the largest range if your sheets have different numbers of rows. How to use the formula to Vlookup across sheets To Vlookup multiple sheets at a time, carry out these steps:\n• Write down all the lookup sheet names somewhere in your workbook and name that range (Lookup_sheets in our case).\n• Adjust the generic formula for your data. In this example, we'll be:\n• in the range A2:A6 (lookup_range) in four worksheets (East, North, South and West), and\n• pull matching values from column B, which is column 2 (col_index_num) in the data range A2:C6 (table_array). With the above arguments, the formula takes this shape: Please notice that we lock both ranges ($A$2:$A$6 and $A$2:$C$6) with absolute cell references.\n• Enter the formula in the topmost cell (B2 in this example) and press to complete it.\n• Double click or drag the fill handle to copy the formula down the column. As the result, we've got the formula to look up the order number in 4 sheets and retrieve the corresponding item. If a specific order number is not found, a #N/A error is displayed like in row 14: To return the amount, simply replace 2 with 3 in the col_index_num argument as amounts are in the 3rd column of the table array: If you'd like to replace the standard #N/A error notation with your own text, wrap the formula into the IFNA function: This generic formula (or its any variation) can also be used to Vlookup multiple sheets in a different workbook. For this, concatenate the workbook name inside INDIRECT like shown in the below formula: If you want to pull data from several columns, a multi-cell array formula can do that in one go. To create such a formula, supply an array constant for the col_index_num argument. In this example, we wish to return the item names (column B) and amounts (column C), which are the 2nd and 3rd columns in the table array, respectively. So, the required array is {2,3}. To correctly enter the formula in multiple cells, this is what you need to do:\n• In the first row, select all the cells to be populated (B2:C2 in our example).\n• Type the formula and press . This enters the same formula in the selected cells, which will return a different value in each column.\n• Drag down the formula to the remaining rows. To better understand the logic, let's break down this basic formula to the individual functions: Working from the inside out, here's what the formula does: In a nutshell, INDIRECT builds the references for all lookup sheets, and COUNTIF counts the occurrences of the lookup value (A2) in each sheet: First, you concatenate the range name (Lookup_sheets) and the range reference ($A$2:$A$6), adding apostrophes and the exclamation point in the right places to make an external reference, and feed the resulting text string to the INDIRECT function to dynamically refer to the lookup sheets: COUNTIF checks each cell in the range A2:A6 on each lookup sheet against the value in A2 on the main sheet and returns the count of matches for each sheet. In our dataset, the order number in A2 (101) is found in the West sheet, which is 4th in the named range, so COUNTIF returns this array: Next, you compare each element of the above array with 0: This yields an array of TRUE (greater than 0) and FALSE (equal to 0) values, which you coerce to 1's and 0's by using a double unary (--), and get the following array as the result: This operation is an extra precaution to handle a situation when a lookup sheet contains several occurrences of the lookup value, in which case COUNTIF would return a count greater than 1, while we want only 1's and 0's in the final array (in a moment, you will understand why). After all these transformations, our formula looks as follows: At this point, a classic INDEX MATCH combination steps in: The MATCH function configured for exact match (0 in the last argument) looks for the value 1 in the array {0;0;0;1} and returns its position, which is 4: The INDEX function uses the number returned by MATCH as the row number argument (row_num), and returns the 4th value in the named range Lookup_sheets, which is West. So, the formula further reduces to: The INDIRECT function processes the text string inside it: And converts it into a reference that goes to the table_array argument of VLOOKUP: Finally, this very standard VLOOKUP formula searches for the A2 value in the first column of the range A2:C6 on the West sheet and returns a match from the 2nd column. That's it!\n\n\n\nDynamic VLOOKUP to return data from multiple sheets into different cells First off, let's define what exactly the word \"dynamic\" means in this context and how this formula is going to be different from the previous ones. In case you have large chunks of data in the same format that are split over multiple spreadsheets, you may want to extract information from different sheets into different cells. The image below illustrates the concept: Unlike the previous formulas that retrieved a value from a specific sheet based on a unique identifier, this time we are looking to extract values from several sheets at a time. There are two different solutions for this task. In both cases, you need to do a little preparatory work and create named ranges for data cells in each lookup sheet. For this example, we defined the following ranges: If you have a reasonable number of sheets to look up, you can use nested IF functions to select the sheet based on the keywords in the predefined cells (cells B1 through D1 in our case). With the lookup value in A2, the formula is follows: Translated into English, the IF part reads: If B1 is East, look in the range named East_Sales; if B1 is North, look in the range named North_Sales; if B1 is South, look in the range named South_Sales; and if B1 is West, look in the range named West_Sales. The range returned by IF goes to table_array of VLOOKUP, which pulls a matching value from the 2nd column on the corresponding sheet. The clever use of mixed references for the lookup value ($A2 - absolute column and relative row) and the logical test of IF (B$1 - relative column and absolute row) allows copying the formula to other cells without any changes - Excel adjusts the references automatically based on the relative position of a row and column. So, we enter the formula in B2, copy it right and down to as many columns and rows as needed, and get the following result: When working with many sheets, multiple nested levels could make the formula too lengthy and difficult to read. A far better way is to create a dynamic vlookup range with the help of INDIRECT: Here, we concatenate the reference to the cell that contains a unique part of the named range (B1) and the common part (_Sales). This produces a text string like \"East_Sales\", which INDIRECT converts to the range name understandable by Excel. As the result, you get a compact formula that works beautifully on any number of sheets:\n\nThat's how to Vlookup between sheets and files in Excel. I thank you for reading and hope to see you on our blog next week!"
    },
    {
        "link": "https://ablebits.com/office-addins-blog/excel-vlookup-tutorial",
        "document": "Today we'll look at how to use VLOOKUP in Excel with many detailed step-by-step examples. You'll learn how to Vlookup from another sheet and different workbook, search with wildcards, and a lot more.\n\nThis article begins a series covering VLOOKUP, one of the most useful Excel functions and at the same time one of the most intricate and least understood. We will try to explain the basics in a very plain language to make the learning curve for an inexperienced user as easy as possible. We will also provide formula examples that cover the most typical usages of VLOOKUP in Excel, and try to make them both informative and fun.\n\nWhat is VLOOKUP? To begin with, it is an Excel function :) What does it do? It searches for the value you specify and returns a matching value from another column. More technically, the function looks up a value in the first column of a given range and returns a value in the same row from another column. In its common usage, Excel VLOOKUP searches through your data set based on the unique identifier and brings you a piece of information associated with that unique identifier. The letter \"V\" stands for \"vertical\" and is used to differentiate VLOOKUP from the HLOOKUP function that looks up a value in a row rather than column (H stands for \"horizontal\"). The function is available in all versions of Excel 365 through Excel 2007. Tip. In Excel 365 and Excel 2021, you can use the XLOOKUP function, which is a more flexible and powerful successor of VLOOKUP. The syntax for the VLOOKUP function is as follows:\n• Lookup_value (required) - is the value to search for.\n\n This can be a value (number, date or text), cell reference (reference to a cell containing a lookup value), or the value returned by some other function. Unlike numbers and cell references, text values should always be in enclosed in \"double quotes\".\n• Table_array (required) - is the range of cells where to search for the lookup value and from which to retrieve a match. The VLOOKUP function always searches in the first column of the table array, which may contain various text values, numbers, dates, and logical values.\n• Col_index_num (required) - is the number of the column from which to return a value. The counting starts from the leftmost column in the table array, which is 1.\n• Range_lookup (optional) - determines whether to search for approximate or exact match:\n• TRUE or omitted (default) - approximate match. If an exact match is not found, the formula searches for the largest value that is smaller than the lookup value. Requires sorting the lookup column in ascending order.\n• FALSE - exact match. The formula searches for a value exactly equal to the lookup value. If an exact match is not found, a #N/A value is returned.\n\nHere is an example of the Excel VLOOKUP formula in its simplest form. Please have a look at the below formula and try to \"translate\" it into English:\n• The 1st argument (lookup_value) clearly indicates that the formula looks up the word \"lion\".\n• The 2nd argument (table_array) is A2:B11. Keeping in mind that the search is performed in the left-most column, you can read the above formula a little further: search for \"lion\" in the range A2:A11. So far, so good, right?\n• The 3rd argument col_index_num is 2. Meaning, we want to return a matching value from column B, which is second in the table array.\n• The 4th argument range_lookup is FALSE, which indicates that we are looking for exact match. With all the arguments established, you should have no problem reading the whole formula: search for \"lion\" in A2:A11, find an exact match, and return a value from column B in the same row. For the sake of convenience, you can type the value of interest in some cell, say E1, replace the \"hardcoded\" text with the cell reference, and get the formula to look up any value you input in E1: Does anything remain unclear? Then try looking at it this way:\n\n \n\n\n\nHow to do a Vlookup in Excel When using VLOOKUP formulas in real-life worksheets, the main rule of thumb is this: lock table array with absolute cell references (like $A$2:$C$11) to prevent it from changing when copying a formula to other cells. The lookup value in most cases should be a relative reference (like E2) or you can lock only the column coordinate ($E2). When the formula gets copied down the column, the reference will adjust automatically for each row. To see how it works in practice, please consider the following example. To our sample table, we have added one more column that ranks the animals by speed (column A) and want to find the 1st, 5th and 10th fastest sprinter in the world. For this, enter the lookup ranks in some cells (E2:E4 in the screenshot below), and use the following formulas: To pull the animal names from column B: To extract speed from column C: Enter the above formulas in cells F2 and G2, select those cells, and drag the formulas to the below rows:\n\n If you investigate the formula in a lower row, you will notice that the lookup value reference has adjusted for that specific row, while the table array is unchanged:\n\n Below, you will have a few more useful tips that will save you a lot of headache and troubleshooting time.\n• The VLOOKUP function cannot look at its left. It always searches in the leftmost column of the table array and returns a value from a column to the right. If you need to pull values from left, use the INDEX MATCH (or INDEX XMATCH in Excel 365) combination that can does not care about the positioning of the lookup and return columns.\n• The VLOOKUP function is case-insensitive, meaning that uppercase and lowercase characters are treated as equivalent. To distinguish the letter case, use case sensitive VLOOKUP formulas.\n• Remember about the importance of the last parameter. Use TRUE for approximate match and FALSE for exact match. For full details, please see VLOOKUP TRUE vs. FALSE.\n• When searching for approximate match, make sure the data in the lookup column is sorted in ascending order.\n• If the lookup value is not found, a #N/A error is returned. For information about other errors, please see Why Excel VLOOKUP is not working.\n\nI hope vertical lookup is starting to look a bit more familiar to you. To strengthen your knowledge, let's build a few more VLOOKUP formulas. How to Vlookup from another sheet in Excel In practice, the Excel VLOOKUP function is rarely used with data in the same worksheet. Most often you will have to pull matching data from a different worksheet. To Vlookup from a different Excel sheet, put the worksheet's name followed by an exclamation mark in the table_array argument before the range reference. For example, to search in the range A2:B10 on Sheet2, use this formula: Of course, you don't have to type the sheet's name manually. Simply, start typing the formula and when it comes to the table_array argument, switch to the lookup worksheet and select the range using the mouse. For instance, this is how you can look up the A2 value in the range A2:A9 on the Prices worksheet and return a matching value from column C:\n• If the spreadsheet name contains spaces or non-alphabetical characters, it must be enclosed in single quotation marks, e.g. 'Price list'!$A$2:$C$9.\n• In case you use a VLOOKUP formula for multiple cells, remember to lock table_array with the $ sign, like $A$2:$C$9. How to Vlookup from another workbook in Excel To Vlookup from a different Excel workbook, put the workbook's name enclosed in square brackets before the worksheet's name. For example, here's the formula to look up the A2 value on the sheet named Prices in the Price_List.xlsx workbook: If either a workbook name or worksheet name contains spaces or non-alphabetical characters, you should enclose them in single quotes like this: The easiest way to make a VLOOKUP formula that refers to a different workbook is this:\n• Start typing your formula, switch to the other workbook, and select the table array using the mouse.\n• Enter the remaining arguments and press the Enter key to complete your formula. The result will look somewhat like the screenshot below:\n\n Once you close the file with your lookup table, the VLOOKUP formula will continue working, but it will now display the full path for the closed workbook:\n\n For more information, please see How to refer to another Excel sheet or workbook.\n\n How to Vlookup from a named range in another sheet In case you plan to use the same lookup range in many formulas, you can create a named range for it and type the name directly in the table_array argument. To create a named range, simply select the cells and type the name you want in the Name box to the left of the Formula bar. For the detailed steps, please see How to name a range in Excel. For this example, we gave the name Prices_2020 to the data cells (A2:C9) in the lookup sheet and get this compact formula: Most names in Excel apply to the entire workbook, so you don't need to specify the worksheet's name when using named ranges. If the named range is in another workbook, put the workbook's name before the range name, for example: Such formulas are far more understandable, aren't they? Besides, using named ranges can be a good alternative to absolute references. Since a named range doesn't change, you can be sure that your table array will remain locked no matter where the formula is moved or copied. If you have converted your lookup range into a fully-functional Excel table, then you can do a Vlookup based on the table name, e.g. Price_table in the below formula: Table references, also called structured references, are resilient and immune to many data manipulations. For instance, you can remove or add new rows to your lookup table without worrying about updating the references.\n\n\n\nLike many other formulas, the Excel VLOOKUP function accepts the following wildcard characters:\n• Asterisk (*) to match any sequence of characters. Wildcards prove really useful in many situations:\n• When you do not remember the exact text you are looking for.\n• When you are looking for a text string that is part of the cell contents.\n• When a lookup column contains leading or trailing spaces. In that case, you may rack your brain trying to figure out why a normal formula does not work. Example 1. Look up text starting or ending with certain characters Suppose you want to find a certain customer in the below database. You do not remember the surname, but you are confident that it starts with \"ack\". To return the last name from column A, use the following Vlookup wildcard formula: To retrieve the license key from column B, use this one (the difference is only in the column index number): You can also enter the known part of the name in some cell, say E1, and combine the wildcard character with the cell reference: The below screenshot shows the results:\n\n Below are a few more VLOOKUP formulas with wildcards. Find the last name ending with \"son\": Get the name that starts with \"joh\" and ends with \"son\": Example 2. VLOOKUP wildcard based on cell value From the previous example, you already know that it is possible to concatenate an ampersand (&) and a cell reference to make a lookup string. To find a value that contains a given character(s) in any position, put an ampersand before and after the cell reference. Let's say, you wish to get a name corresponding to a certain license key, but you don't know the whole key, only a few characters. With the keys in column A, names in column B, and part of the target key in E1, you can do a wildcard Vlookup in this way:\n• For a wildcard VLOOKUP formula to work correctly, use an exact match (FALSE is the last argument).\n• If more than one match is found, the first one is returned.\n\nAnd now, it's time to take a closer look at the last argument of the Excel VLOOKUP function. Though optional, the range_lookup parameter is highly important. Depending on whether you choose TRUE or FALSE, your formula may yield different results. If range_lookup is set to FALSE, a Vlookup formula searches for a value that is exactly equal to the lookup value. If two or more matches are found, the 1st one is returned. If an exact match is not found, the #N/A error occurs. If range_lookup is set to TRUE or omitted (default), the formula looks up the closest match. More precisely, it searches for an exact match first, and if an exact match is not found, looks for the next largest value that is less than the lookup value. An approximate match Vlookup works with the following caveats:\n• The lookup column must be sorted in ascending order, from smallest to largest, otherwise a correct value may not be found.\n• If the lookup value is smaller than the smallest value in the lookup array, a #N/A error is returned. The following examples will help you better understand the difference between an exact match and approximate match Vlookup and when each formula is best to be used.\n\n Example 1. How to do an exact match Vlookup To look up an exact match, just put FALSE in the last argument. For this example, let's take the animal speed table, swap the columns, and try to find the animals that can run 80, 50 and 30 miles per hour. With the lookup values in D2, D3 and D4, enter the below formula in E2, and then copy it down to two more cells: As you can see, the formula returns \"Lion\" in E3 because they run exactly 50 per hour. For the other two lookup values an exact match is not found, and #N/A errors appear.\n\n \n\n Example 2. How to Vlookup for approximate match To look up an approximate match, there are two essential things you need to do:\n• Sort the first column of table_array from smallest to largest.\n• Use TRUE for the range_lookup argument or omit it. Sorting the lookup column is very important because the VLOOKUP function stops searching as soon as it finds a close match smaller than the lookup value. If the data is not sorted properly, you may end up having really strange results or a bunch of #N/A errors. For our sample data, an approximate match Vlookup formula goes as follows: And returns the following results:\n• For a lookup value of \"80\", \"Cheetah\" is returned because its speed (70) is the closest match that is smaller than the lookup value.\n• For a lookup value of \"50\", an exact match is returned (Lion).\n• For a lookup value of \"30\", a #N/A error is returned because the lookup value is less than the smallest value in the lookup column.\n\nUndoubtedly, VLOOKUP is one of the most powerful and useful Excel functions, but it's also one of the most confusing ones. To make the learning curve less steep and experience more enjoyable, we included a couple of time-saving tools in our Ultimate Suite for Excel. The interactive VLOOKUP Wizard will walk you through the configuration options to build a perfect formula for the criteria you specify. Depending on your data structure, it will use the standard VLOOKUP function or an INDEX MATCH formula that can pull values from left. To get your custom-tailored formula, this is what you need to do:\n• Specify the following columns (in many cases they are picked automatically):\n• Key column - the column in your main table containing the values to look up.\n• Lookup column - the column to look up against.\n• Return column - the column from which to retrieve values. The following examples show the wizard in action. When the lookup column (Animal) is the leftmost column in the lookup table, a normal VLOOKUP formula for exact match is inserted:\n\n \n\n When the lookup column (Animal) is on the right side of the return column (Speed), the wizard inserts an INDEX MATCH formula to Vlookup right to left:\n\n Extra bonus! Due to the clever use of cells references, the formulas can be copied or moved to any column, without you having to update the references.\n\n If your Excel files are enormously large and complex, the project's deadline is imminent, and you are looking for someone who can lend you a helping hand, try out the Merge Tables Wizard. This tool is our visual and stress-free alternative to Excel's VLOOKUP function, which works this way:\n• Choose one or several common columns as the unique identifier(s).\n• Specify which columns to update.\n• Allow the Merge Tables Wizard a few seconds for processing… and enjoy the results :)\n\nThat's how to use VLOOKUP in Excel at the basic level. In the next part of our tutorial, we will discuss advanced VLOOKUP examples that will teach you how to Vlookup multiple criteria, return all matches or Nth occurrence, perform double Vlookup, look up across multiple sheets with a single formula, and more. I thank you for reading and hope to see you next week!"
    },
    {
        "link": "https://datacamp.com/tutorial/vlookup-from-another-sheet-Excel",
        "document": "Have you ever spent hours manually searching through spreadsheets to find matching data? I've been there, and it's frustrating. That's why I'll show you how changed that way I work with Excel — and how it can do the same for you.\n\nIn this guide, you will understand how to use to search and retrieve data, whether in different sheets of your workbook or even in entirely separate Excel files. However, if you're not familiar with Excel functions at all, start with our Introduction to Excel course to get familiar with the basics.\n\nThe Quick Answer: How to Use VLOOKUP() from Another Sheet\n\nHere's the fastest way to use to find data in another sheet:\n\nThe key is in the second argument, where you reference the range in another sheet. You have to add the sheet name followed by an exclamation mark before your range, like this:\n\nFor example, if you're looking up a customer ID in the Customers sheet, you would use this syntax:\n\nAnd if your sheet name contains spaces, simply wrap it in single quotes like this:\n\nWhy We Use VLOOKUP() from Another Sheet\n\n, as you may know, lets you search for a value in a table and pull back a related value from a specified column. I say column because the ‘V’ in means ‘vertical’. is great because it mean, when you update information in one place, the information in another place is also updated. That is, updates happen automatically everywhere they're referenced.\n\nNow, I use across different sheets because I store different types of information in different places. This sounds obvious but has an implication: It gives me a specific sheet that I could use for manual data entry, and it also, therefore, eliminates errors that can creep in. By knowing how to use from another sheet, I am better able to maintain clean datasets without redundant details. I can work faster, and I make fewer mistakes.\n\nA Closer Look at VLOOKUP() from Another Sheet\n\nThe first step in using across sheets is figuring out what information you'll use to connect the data. We call this the lookup value or common field. It's the data that exists in both sheets and helps Excel match things up, and you must format it consistently in both sheets. Minor formatting differences, like hidden spaces or inconsistent data types, can give an error.\n\nSo, before you start writing your formula, make sure the lookup value exists in both sheets, the data types, like text or numbers, are consistent, and there are no hidden spaces or trailing characters.\n\nWhen writing a that pulls data from another sheet, the main adjustment is in the parameter. You must add the sheet name followed by an exclamation mark ( ) before your range.\n\nLet's say you have two sheets: Employee Data (where the data is stored) and Salary Data (where you want to display the salaries of each employee based on lookup value).\n\nTo transfer the salaries from the Employee Data sheet to the Salary Data sheet:\n• Select the cell where you want the result.\n• Reference the other sheet (this is the key part):\n• Complete the formula ( for specifying column, for exact match):\n\nWhen the above formula is applied, you'll get the following results:\n\nI would say that the most common mistake in a cross-sheet is incorrect sheet name references. So double-check this part of your formula if you ever face any issues in performing a cross-sheet .\n\nExample VLOOKUP() from another sheet\n\nLet's see another example. I have two sheets — Flavors and Total Sale. In the Total Sale sheet, I want to record the total sales of all the ice cream flavors for a month.\n\nThe Flavors sheet looks like this:\n\nThe Total Sale sheet looks like this:\n\nTo get the total sales of the ice cream flavors from the Flavors sheet, I apply the following formula in cell B2 of the Total Sale sheet:\n\nThis formula looks at the value in A2, searches for it in the Flavors sheet, and returns the result from the fifth column when it finds a match.\n\nTotal sales from one sheet to another. Image by Author\n\nAlthough it’d be easy to perform once you clearly understand how it works, you may encounter errors. Let’s see what are they and how to handle them:\n\nThe dreaded error in can be frustrating, but it's usually fixable once you understand the cause. Here's how to spot and resolve:\n• Mismatched Data Types: Sometimes, your lookup value may be stored as text in one sheet and as a number in another. Excel sees these as different, even if they look the same to you.\n• Incorrect References: You may be looking in the wrong place – either the wrong sheet or the wrong range of cells. Double-check your sheet names and cell ranges. Make sure you've spelled the sheet name correctly and that your range includes all necessary data.\n• Exact Match Issues: If you're using for an exact match (usually recommended), your lookup value must match exactly what's in your table. So make sure there are no hidden spaces — you can even use the function to remove them.\n• Lookup Value Not in the First Column: always looks for the lookup value in the first column of your range. So, make sure your lookup column is the leftmost column in your range.\n• Broken References: If the sheet you're referencing is renamed, deleted, or moved, formulas will break and give errors. To avoid this, keep your referenced sheets intact.\n\nCheck for consistent formatting before looking up data between sheets. To do so, you can use Excel's or functions. For example, you can use the function within like this:\n\nThis will indicate to Excel that your lookup value should be treated as text, which can help if your other sheet stores things as text, too.\n\nOtherwise, instead of showing errors, you can provide more user-friendly messages using the formula. Here’s how:\n\nFor nested error handling with different messages:\n\nFor more details on how to combine and , read my detailed tutorial, How to Combine VLOOKUP() with IF() in Excel.\n\nacross sheets is one of Excel's most powerful features for anyone working with multiple datasets. Once you master the simple trick of adding the sheet name to your formula, you can pull data from anywhere in your workbook. While the errors may look frustrating at first, most issues come down to simple data mismatches that are easy to fix once you know what to look for.\n\nThe best way to get comfortable with a cross-sheet is to practice with your own data. Start with simple lookups between two sheets, then gradually add error handling as you build confidence. For more advanced Excel techniques, DataCamp offers a variety of Excel tutorials to help you advance your skills. Also, our Excel Fundamentals skill track always looks good on a resume.\n\nFinally, if you are looking to understand more of the nuance around , check out my other tutorials:"
    },
    {
        "link": "https://unito.io/blog/use-vlookup-excel",
        "document": "Microsoft Excel is easily one of the most widely-used tools today. Whether it’s a large enterprise using it to crunch data from thousands of sources across a hundred locations or a small company using it for everything from bookkeeping to tracking employee hours. But just entering data into your spreadsheets is one thing; you also need to know how to manipulate it. And sometimes, that means grabbing data from one sheet and displaying it in another. That’s where using VLOOKUP to pull Excel data from another sheet comes in.\n\nVLOOKUP — which stands for Vertical Lookup — is an Excel formula that lets you search for a specific value in a table and return it in another cell of the same table. But you can also use it across spreadsheets. Here’s how.\n\nVLOOKUP from another sheet step 1: Identify the common field\n\nBefore you start typing in any formulas, you need to know what you’re looking up. Look through both sheets and identify the common field that you’ll need to plug into your formula. For example, you might need to look up an employee’s phone number in your employee database to add it to a spreadsheet of your company’s softball team. Or you need to pull up the SKU for a number of products to create a database of your next store-wide promotion. Whatever the case, before you use VLOOKUP to pull data from another sheet, you need to make sure that this common field is formatted in exactly the same way in both sheets. Otherwise, you might run into some errors.\n\nOnce you’ve found the common field you need to look up, you have to determine where that value is located in the first spreadsheet. You can either take down the data range manually or highlight it with your cursor. That way, the VLOOKUP function will know where to look.\n\nVLOOKUP from another sheet step 3: Enter the VLOOKUP function\n\nGo to the cell where you want to display the result and start by typing =VLOOKUP(. Then specify the lookup value, the range of data, and the column number that you want to retrieve the value from. Here’s an example of a formula to use VLOOKUP with a different Excel sheet:\n• B2 refers to the common field within the table where you’re running the formula.\n• File name refers to the file name for the sheet you’re looking up data from.\n• Sheet name is the name of the sheet you’re pulling data from.\n• A$2:B$249 is the range of data from the source sheet.\n• 2 is the indicator of the column which the formula should return (with the leftmost column of the range counting as 1)\n• As VLOOKUP is usually defaulting to searching for the closest match, “false” makes sure VLOOKUP is only returning values if there is an exact match.\n\nYou’ll have an easier time running VLOOKUP from another Excel sheet if you keep both sheets open side by side. That way, you can simply click in your second sheet to choose your data range.\n\nThe last step is always to check your work! Once you’ve entered the VLOOKUP formula, check the cell to make sure it’s been populated correctly. If you get an error, you might have to go back and correct the formula. But if the data you get isn’t what you expected, there might be an issue with your data range.\n\nHow to get more data from another sheet than VLOOKUP\n\nVLOOKUP is a great way to quickly look up data from one sheet and feed it to another. But it’s not necessarily always the best way to keep your records up to date. That’s because you need to manually input the formula any time you need that data. And if you’re not an Excel aficionado, that can get tricky.\n\nUnito is a no-code two-way sync tool with some of the deepest integrations for the most popular tools on the market, including Excel, Google Sheets, Airtable, Notion, and more. With a Unito flow, you can sync records from spreadsheet to spreadsheet, and they’ll be automatically updated in both tools in real time. It’s a bit like VLOOKUP, except you don’t need to know any formulas — and it works across tools\n\nCurious? Find out what Unito’s Excel integration can do here.\n\nUsing VLOOKUP in two Excel sheets FAQ\n\nHere are the answers to some of the most common questions about using VLOOKUP with two Excel sheets.\n\nHow to do a VLOOKUP in two different Excel web files?\n\nUnfortunately, you can currently not use the VLOOKUP function in one Excel web file to import data from another Excel web file. This is only possible on the desktop version of Excel.\n\nWhat’s the difference between VLOOKUP and XLOOKUP?\n\nWhile VLOOKUP looks for data in a single column, XLOOKUP will give you more flexibility. You can choose to search either in a row or column as well as handle missing data with an optional argument. You’ll also be able to use wildcards for better partial value matching, and XLOOKUP formulas are less likely to break than their VLOOKUP equivalents.\n\nWhat’s the difference between VLOOKUP and HLOOKUP?\n\nVLOOKUP looks up data in spreadsheet columns while HLOOKUP will look up data in rows — and send it to another row.\n\nWhat’s the difference between VLOOKUP and INDEX MATCH?\n\nBoth formulas will look up data in your spreadsheets, but VLOOKUP will look for a value in the leftmost column of your sheet while INDEX MATCH will look for a specific value in multiple columns.\n\nWhat are some other formulas that work in Excel?\n\nIn this blog post, we break down some of the most popular formulas for Google Sheets and how they work. Most of them are 100% compatible with Excel, too."
    },
    {
        "link": "https://indeed.com/career-advice/career-development/vlookup-example-between-two-sheets",
        "document": "How To Create a VLOOKUP Between Two Sheets (With Example)\n\nVLOOKUP is a function in Excel spreadsheets that can locate specific information in cells. People use this function to search through large data across a worksheet of various worksheets so they can maintain organized data while still being able to access pieces of information. Through this function, you can locate, pull and organize data automatically versus a manual search and find.\n\nUsing VLOOKUP between two Excel sheets\n\nReasons you might use the VLOOKUP function between multiple sheets are various, including to:\n• None A VLOOKUP between two A VLOOKUP between two spreadsheets allows you to organize your data as needed on separate sheets. Though you might record data on these individual worksheets, a VLOOKUP allows you to still access and reference data across each.\n• None Connecting data means you can view data in new ways as you might arrange it in specific ways or include different information on each sheet. Connecting unique data points can help you understand information differently, which can inform your Connecting data means you can view data in new ways as you might arrange it in specific ways or include different information on each sheet. Connecting unique data points can help you understand information differently, which can inform your decision-making\n• None Rather than manually copying and pasting data across Rather than manually copying and pasting data across worksheets , VLOOKUP can help you quickly run queries and populate data. This can save you time and prevent manual errors when navigating between sheets.\n• None By using a VLOOKUP—instead of By using a VLOOKUP—instead of copying and pasting—the data in your destination cells update automatically if you update the information in the source tables.\n\nHow to VLOOKUP between two Excel sheets\n\nHere are the steps for applying VLOOKUP between two sheets:\n\nThere are several components you want to include when performing the VLOOKUP function between sheets. Rather than including the table array as you would for one sheet, you want to indicate the sheet range for the data. Here is what the formula might look like:\n\nYou can define each of these components as:\n• None This is the value you search for.\n• None This includes both the table array and the sheet where you want to gather the information. For example, this might appear as \" \".\n• None This is the column number where you hope to collect data. This matches the column sequence in the table array selected.\n• None This is optional, but you can include TRUE to gather approximate matches or FALSE to generate an exact match.\n\nIn the cell where you hope to populate data, you can enter the specific criteria you hope to search. For example, if you're hoping to gather data onto a summary tab from a worksheet named \" \", using table data ranging from cells A2 through E6, your formula may look like this:\n\nThis means you will gather data for cell A2 from the \" \" worksheet within the second column in the table array A2 through E6.\n\nYou can also perform a VLOOKUP between separate workbooks. To do so, include the name of the workbook and the sheet within the workbook where you wish to gather data. Here’s the formula you can use:\n\nExample of a VLOOKUP between two sheets\n\nHere is an example of a VLOOKUP between two sheets:\n\nHot Cup Coffee Shop records its monthly sales in a spreadsheet, with each tab a separate month of the year. Here are the sheets with its sales data:\n\nThis populates the number $1,200 on the summary tab. They now click the cell and drag it across the next three rows to populate the data for those fields. Once complete, the summary table looks like this:\n\nThey repeat this step for each month, updating the sheet name in the formula for each monthly column to gather data for the other months.\n\nTips for using VLOOKUP between two sheets\n\nHere are some tips you can use when performing a VLOOKUP between two sheets:\n• None The VLOOKUP tool can be most effective if you're gathering relevant data. For example, if you're gathering customer information where you have different information on separate tabs, verify there is an equivalent column, like customer ID, to avoid The VLOOKUP tool can be most effective if you're gathering relevant data. For example, if you're gathering customer information where you have different information on separate tabs, verify there is an equivalent column, like customer ID, to avoid errors when performing the function.\n• None If your sheet name has special characters or spaces, including single quotations around its name in the formula will ensure you can look up the right data. This might look like \" \".\n• None Rather than manually inputting ranges into the formula for the range, you can navigate to the separate worksheet and highlight the table range. This can help you accurately select the range where you hope to find data.\n• None If you want to look up exact matches for data, ensure you include \" \" or \" \" as the range lookup value. VLOOKUP defaults to approximate matches, which means if you have sorted your data in the source table differently than the destination table, your values will populate based on row number rather than the value indicated in your table.\n\nPlease note that none of the companies mentioned in this article are affiliated with Indeed."
    },
    {
        "link": "https://answers.microsoft.com/en-us/msoffice/forum/all/vlookup-na-error-despite-having-verified-the-value/b669748b-1bdc-4574-8550-320d2dca607a",
        "document": ""
    },
    {
        "link": "https://reddit.com/r/excel/comments/mv7cok/vlookup_not_finding_all_values_only_some_comes",
        "document": "I am certain my vlookup is correct and it is returning some values.\n\nThe values that are missing, I have confirmed that they are in the field that the vlookup is searching by copy and pasting the word that the vlookup is looking for and the word that I am trying to find in the result field is definitely there."
    },
    {
        "link": "https://ablebits.com/office-addins-blog/excel-vlookup-not-working",
        "document": "Is your VLOOKUP pulling wrong data or you cannot get it to work at all? This tutorial shows how you can quickly fix common VLOOKUP errors and overcome its main limitations.\n\nIn a few earlier articles, we explored different aspects of the Excel VLOOKUP function. If you have been following us closely, by now you should be an expert in this area :)\n\nHowever, it's not without reason that many Excel specialists consider VLOOKUP to be one of the most intricate Excel functions. It has a ton of limitations, which are the source of various problems and errors.\n\n\n\nIn this article, you will find simple explanations of the main causes of VLOOKUP errors such as #N/A, #NAME and #VALUE, as well as their solutions and fixes. We will start with the most obvious reasons why VLOOKUP is not working, so it might be a good idea to check out the below troubleshooting steps in order.\n\nIn VLOOKUP formulas, the #N/A error message (meaning \"not available\") is displayed when Excel cannot find a lookup value. There can be several reasons why that may happen. 1. The lookup value is misspelt It's always a good idea to check the most obvious thing first : ) Misprints frequently occur when you are working with really large data sets consisting of thousands of rows, or when a lookup value is typed directly in the formula.\n\n If your formula looks up the closest match, (range_lookup argument set to TRUE or omitted), the #N/A error can appear in two cases:\n• The lookup value is smaller than the smallest value in the lookup array.\n• The lookup column is not sorted in ascending order. If you are searching for exact match (range_lookup argument set to FALSE), the #N/A error occurs when a value exactly equal to the lookup value is not found. For more information, see VLOOKUP exact match vs. approximate match.\n\n 4. The lookup column is not the leftmost column of the table array One of the most significant limitations of Excel VLOOKUP is that it cannot look to its left. Consequently, a lookup column should always be the leftmost column in the table array. In practice, we often forget about this and end up with #N/A errors.\n\n Solution: If it is not possible to restructure your data so that the lookup column is the left-most column, you can use the INDEX and MATCH functions together as an alternative to VLOOKUP. Here's a formula example: INDEX MATCH formula to look up values to left.\n\n Another common source #N/A errors in VLOOKUP formulas is numbers formatted as text, either in the main or lookup table. This usually occurs when you import data from some external database or if you've typed an apostrophe before a number to show leading zeros. Here are the most obvious indicators of numbers formatted as text:\n\n Solution: Select all the problematic numbers, click on the error icon and choose Convert to Number from the context menu. For more information, please see How to convert text to number in Excel.\n\n This is the least obvious cause of the VLOOKUP #N/A error because a human eye can hardly spot those extra spaces, especially when working with big datasets where most of the entries are below the scroll. Solution 1: Extra spaces in the lookup value To ensure the correct work of your VLOOKUP formula, wrap the lookup value in the TRIM function: If extra spaces occur in the lookup column, there is no easy way to avoid #N/A errors in VLOOKUP. Instead, you can use a combination of INDEX, MATCH and TRIM functions as an array formula: Since this is an array formula, don't forget to press Ctrl + Shift + Enter to properly complete it (in Excel 365 and Excel 2021 where arrays are native, this also works as a regular formula).\n\n Tip. A quick alternative is running the Trim Spaces tool that will eliminate excess spaces both in the lookup and main tables in seconds, making your VLOOKUP formulas error-free.\n\nIn general, Microsoft Excel displays the #VALUE! error if a value used in the formula is of a wrong data type. In respect to VLOOKUP, there are three common sources of the VALUE! error. Please be aware that VLOOKUP cannot look up values containing more than 255 characters. If your lookup values exceed this limit, a #VALUE! error will be displayed:\n\n Solution: Use an INDEX MATCH formula instead. In our case, this formula works perfectly: 2. Full path to the lookup workbook is not supplied If you are pulling data from another workbook, you have to include the full path to it. More precisely, you have to enclose the workbook's name including the extension in [square brackets] and specify the sheet's name followed by the exclamation mark. If the workbook name or sheet name, or both, contain spaces or any non-alphabetical characters, the path must be enclosed in single quotation marks. Here's the structure of the table_array argument to Vlookup from another workbook: A real formula might look similar to this: The above formula will search for the value of A2 in column B of Sheet1 in the New Prices workbook, and return a matching value from column D. If any element of the path is missing, your VLOOKUP formula won't work and return the #VALUE error (unless the lookup workbook is currently open). For more information, please see:\n• How to refer to another sheet or workbook in Excel\n• How to do Vlookup from a different workbook 3. The col_index_num argument is less than 1 It's hard to imagine a situation when someone intentionally enter a number less than 1 to specify the column to return values from. But it may happen if this argument is returned by some other function nested in your VLOOKUP formula. So, if the col_index_num argument is than 1, your formula will return the #VALUE! error too. If col_index_num is greater than the number of the columns in the table array, VLOOKUP produces the #REF! error.\n\n\n\nThe main causes of errors in Excel VLOOKUP Apart from having a fairly complicated syntax, VLOOKUP has arguably more limitations than any other Excel function. Because of these limitations, a seemingly correct formula may often deliver results different from what you expected. Below you will find solutions for a few typical scenarios when VLOOKUP fails. The VLOOKUP function does not distinguish the letter case and teats lowercase and uppercase characters as identical. Solution: Use VLOOKUP, XLOOKUP or INDEX MATCH in combination with the EXACT function that can match text case. You can find the detailed explanations and formula examples in this tutorial: 5 ways to do a case-sensitive Vlookup in Excel.\n\n A new column was inserted or removed from the table Regrettably, VLOOKUP formulas stop working every time when a new column is deleted from or added to the lookup table. This happens because the syntax of the VLOOKUP function requires defining the index number of the return column. When a new column is added to/removed from the table array, obviously that index number changes. Solution: The INDEX MATCH formula comes to the rescue again : ) With INDEX MATCH, you specify the lookup and return ranges separately, so you are free to delete or insert as many columns as you want without worrying about updating every associated formula.\n\n Cell references change when copying the formula to other cells The heading gives an exhaustive explanation of the problem, right? Solution: Always use absolute references (with the $ sign) for the table_array argument, e.g. $A$2:$C$100 or $A:$C. You can quickly switch between different reference types by pressing the F4 key.\n\n VLOOKUP returns the first found value As you already know, Excel VLOOKUP returns the first value it finds. However, you can force it to bring the 2nd, 3rd, 4th or any other occurrence you want. There is also a way to get the last match or all found matches. Solutions: Formula examples are available here:\n• XLOOKUP formula to get the last match\n\nWhy does my VLOOKUP work for some cells but not others? When your VLOOKUP formula returns the correct data I some cells and #N/A errors in others, there can be a few possible reasons why that happens. 1. The table array is not locked Suppose you have this formula in row 2 (say in E2), which works nicely: When copied to row 3, the formula changes to: Because a relative reference is used for table_array, it changes based on the relative position of the row where the formula is copied, in our case from A2:B10 to A3:B11. So, if the match is in row 2, it won't be found! Solution: When using a VLOOKUP formula for more than one cell, always lock the table array reference with the $ sign like $A$2:$B$10. 2. Text values or data types do not match Another common reason for VLOOKUP failure is the difference between your lookup value and a similar value in the lookup column. In some cases, the difference is so subtle that it's hard to spot visually. Solution: When VLOOKUP is returning an #N/A error while you can clearly see the lookup value in the lookup column, and apparently both are spelt exactly the same, the first thing you need to do is to determine the root cause of the problem - the formula or the source data. To see whether the two values are the same or different, make a direct comparison in this way: Where E1 is your lookup value and A4 is an identical value in the lookup column. If the formula returns FALSE, that means the values differ in some way, though they look absolutely alike. In case of numeric values, the most possible reason is numbers formatted as text. In case of text values, most likely the problem is in excess spaces. To verify this, find out the total length of the two strings using the LEN function: If the resulting numbers are different (like in the screenshot below), then you've pinpointed the culprit - extra spaces:\n\n To solve the issue, either remove extra spaces or use this INDEX MATCH TRIM formula as a workaround.\n\n\n\nHow to Vlookup without errors in Excel If you do not want to intimidate your users with standard Excel error notations, you can display your own user-friendly text instead or return a blank cell if nothing is found. This can be done by using VLOOKUP with IFERROR or IFNA function. In Excel 2007 and later, you can use the IFERROR function to check a VLOOKUP formula for errors and return your own text (or an empty string) if any error is detected. In Excel 2003 and earlier, you can use the IF ISERROR formula for the same purpose: For more details, please see Using IFERROR with VLOOKUP in Excel.\n\n To trap only #N/A errors ignoring all other error types, use the IFNA function (in Excel 2013 and higher) or IF ISNA formula (in all versions). =IFNA(VLOOKUP(E1, A2:B10, 2, FALSE), \"Oops, no match is found. Please try again!\") =IF(ISNA(VLOOKUP(E1, A2:B10, 2, FALSE)), \"Oops, no match is found. Please try again!\", VLOOKUP(E1, A2:B10, 2, FALSE)) \n\n \n\n\n\nThat's all for today. Hopefully, this tutorial will help you get rid of VLOOKUP errors and have your formulas working in the way you want."
    },
    {
        "link": "https://quora.com/If-there-is-no-match-with-a-vlookup-formula-in-Excel-what-happens",
        "document": "Something went wrong. Wait a moment and try again."
    },
    {
        "link": "https://reddit.com/r/excel/comments/108hvwj/excel_showing_na_for_vlookup_even_with_exact_same",
        "document": "I have a recurring issue in excel that makes no sense at all. If i have the EXACT same value in two sheets and I do a VLOOKUP to validate it's there, I get an #NA. Error shown below.\n\n12345 is found somehow, but 12346 not found. How can this be possible? I've tried trimming BOTH datasets, did nothing. Converted both column to number... nothing .\n\nedit: Discovered something very strange. If I double click the value in the ID column to 'edit' and then press enter, VLOOKUP magically now finds it. Have to do it one by one every single cell in my lookup column"
    }
]