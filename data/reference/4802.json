[
    {
        "link": "https://stackoverflow.com/questions/15748800/extract-text-by-line-from-pdf-using-itextsharp-c-sharp",
        "document": "I need to run some analysis my extracting data from a PDF document.\n\nUsing , I used the method to extract contents from a PDF document and it returned me in a single long line.\n\nIs there a way to get the text by line so that i can store them in an array? So that i can analyze the data by line which will be more flexible.\n\nBelow is the code I used:"
    },
    {
        "link": "https://itextpdf.com/products/itextsharp",
        "document": "iTextSharp is EOL and has transitioned to maintenance mode, meaning it only receives security related releases and fixes to allow users who have developed their solutions using iTextSharp to safely continue using it. No new features will be added.\n\nFor new implementations we strongly recommend iText Core, which is available under the same dual licensing (AGPL and commercial) conditions as iTextSharp and offers numerous improvements and benefits."
    },
    {
        "link": "https://stackoverflow.com/questions/8821107/pdf-text-extraction-using-itext",
        "document": "Q. Is it possible to extract text from pdf per line in iText?\n\nA. PDF is based on a charting system (X,Y co-ordinates) Thus all PDF writers and reader's are based on \"area by area\". Such that the smallest single unit is in effect each page not the lines of text that can be in any angle or order.\n\nThus to be forced to work \"Line-wise\" there would need to be named functions or switches. Certainly iText could do that as per other answers. But for simplicity I propose in basic cases try PDFtoText first. That way you can pick from newly numbered lines.\n\nSo for the first 31 lines of this page."
    },
    {
        "link": "https://ironpdf.com/blog/compare-to-other-components/extract-text-from-pdf-csharp-itextsharp",
        "document": "Test in production without watermarks.\n\nWorks wherever you need it to."
    },
    {
        "link": "https://dev.to/eliotjones/reading-a-pdf-in-c-on-net-core-43ef",
        "document": "The question anyone who has tried to extract text from a PDF using C# will have asked themselves at one point or another is: why is this so complicated?\n\nIt's a good question and the answer lies in trade-offs made when the PDF format was designed.\n\nTo those unfamiliar with it I'd describe a PDF file as a picture. At a very high level it's a set of images defining how the pages in the document should appear. This means whatever platform you view it on, it should look (more-or-less) identical, whether you're on Windows, Linux, Chrome, Android, etc. The fact it contains text and font information is almost, but not quite, incidental.\n\nThe presence of fonts in the file helps applications that display PDFs draw text in (almost) the same way across platforms. The text content included in a document mostly just defines where letters from a font should be drawn. There are even some documents containing fonts where the text information has no actual relationship to the displayed glyphs, you might have encountered them before; in these documents if you highlight and copy paste some text that appears 'normal' when you paste it to another application it's just nonsense.\n\nWith that in mind there's no such thing as 'perfect' (or a lot of the time even passable) text extraction from PDFs. They're not primarily designed to transmit the text in a useful way, it's pretty much a side effect of the requirement to render the document that it even contains text at all.\n\nFor this reason some people just run OCR against all PDF documents and rely on the OCR to extract text from what is, and I'm repeating myself here, basically an image.\n\nIf you don't want to run OCR and you don't want to fork out a considerable amount of money for commercially licensed PDF software, what are your options for getting text out of a PDF in C#?\n\nFor the following examples I'm targeting .NET Core 2.1 on Windows 10 using Visual Studio 2017. I'll be using the sample PDF found here but you can use any PDF file.\n\nFor the licensing discussion below - the traditional disclaimer that I am not a lawyer, I don't particularly understand software licenses. Consult someone who understands this stuff if licensing is a real issue for you.\n\nThe original. One of the more well established PDF libraries in C#. Most versions of iTextSharp (now iText as of version 7) are covered by the AGPL. This is quite an 'aggressive' license that cannot be used for commercial purposes unless you also release your entire source code as source available (controversial take, I don't really consider AGPL open source) under the AGPL, or buy a commercial license.\n\nThere's an unofficial fork of iTextSharp from back when it was LGPL licensed (this is still a copyleft license - note that this link is to LGPL v2.1 rather than v2) before the change to the AGPL license with some recent changes to port it to .NET Core.\n\n\n\nOnce you have the package installed you can refer to the examples on GitHub to accomplish most tasks. The following code opens a file from disk and write the text content to the console:\n\n\n\nThe iTextSharp API has always struck me as a bit tricky to understand and the licensing would be a deal-breaker for me, even under the LGPL rather than AGPL. However you get access to the power of one of the largest, feature complete, C# PDF libraries.\n\nDisclaimer: I'm the maintainer of this package.\n\nPdfPig is an Apache 2.0 licensed library started as an attempt to port the Java PDFBox project to C#. I built PdfPig with a particular focus on extracting text from PDFs. Other use-cases like creating PDFs are less well supported, or for PDF to image or HTML to PDF, not supported at all.\n\nFirst get the package from NuGet:\n\n\n\nThen to open and extract the text, like we did for the previous library:\n\n\n\nPdfPig provides multiple text extraction strategies. Porting the excellent PDFBox is an outstanding issue but PdfPig exposes a rich API based around letters to support any custom text extraction logic.\n\nEach page gives you access the the letters and their exact position on the page, plus almost all the information you could possibly want. Given the difficulty of extracting text content in a reliable order PdfPig is designed so that you can extract PDF text in any way you might need to, and enables you to build your own post-processing pipelines to give you the best possible results for your use-case.\n\ndocnet wraps the PDFium C++ library used by Chromium. It provides a C# API for the functionality available in the C++ library. This MIT licensed wrapper wraps the Apache 2.0 licensed PDFium code so is properly open source.\n\n\n\nThen you can extract the content from each page, or access the letters directly:\n\n\n\ndocnet gives you the speed benefit of native libraries as well as the reassurance of running the PDF code which powers Chromium and by extension, Chrome. Currently it restricts you to targeting x64 but this may change in future.\n\nThis is a port of the MIT licensed PdfSharp library to .NET Core. It seems to be primarily focused on creating, rather than reading, PDFs but also supports other operations. It also replaces the System.Drawing dependency of the original PDfSharp with the more cross-platform friendly ImageSharp library; which means, as usual, you should check the licenses of the dependencies (there was some talk of changing the ImageSharp license recently).\n\nI couldn't find an immediately obvious API for text extraction and there seems to be an open issue for text extraction, but I thought I'd mention it as an option if you're looking to convert PDF to image, or work with the internal PDF structure.\n\nWe reviewed a few of the options available to a developer looking to read text from a PDF in C# on .NET Core. There's some difficulty finding proper open-source, rather than commercial or copyleft licensed software to achieve this task.\n\nEven when we find a library it's still never going to extract text in reading order perfectly 100% of the time, since PDF was never designed to support this.\n\nI've included the options I'm aware of, but if you feel I've missed any let me know in the comments.\n\nI hope this article helps you write great software to bring the power of PDF to the people!"
    },
    {
        "link": "https://stackoverflow.com/questions/15748800/extract-text-by-line-from-pdf-using-itextsharp-c-sharp",
        "document": "I need to run some analysis my extracting data from a PDF document.\n\nUsing , I used the method to extract contents from a PDF document and it returned me in a single long line.\n\nIs there a way to get the text by line so that i can store them in an array? So that i can analyze the data by line which will be more flexible.\n\nBelow is the code I used:"
    },
    {
        "link": "https://stackoverflow.com/questions/16398483/how-can-we-extract-text-from-pdf-using-itextsharp-with-spaces",
        "document": "The backgrounds on why space between words sometimes is not properly recognized by iText(Sharp) or other PDF text extractors, have been explained in this answer to \"itext java pdf to text creation\": These 'spaces' are not necessarily created using a space character but instead using an operation creating a small gap. These operations are also used for other purposes (which do not break words), though, and so a text extractor must use heuristics to decide whether such a gap is a word break or not...\n\nThis especially implies that you never get a 100% secure word break detection.\n\nWhat you can do, though, is to improve the heuristics used.\n\niText and iTextSharp standard text extraction strategies, e.g. assume a word break in a line if\n\na) there is a space character or\n\nb) there is a gap at least as wide as half a space character.\n\nItem a is a sure hit but item b may often fail in case of densely set text. The OP of the question to the answer referenced above got quite good results using a fourth of the width of a space character instead.\n\nYou can tweak these criteria by copying and changing the text extraction strategy of your choice.\n\nIn the you find this criterion embedded in the method:\n\nIn case of the this criterion meanwhile has been put into a method of its own:\n\nThe intention for putting this into a method of its own was to merely require simple subclassing of the strategy and overriding this method to adjust the heuristics criteria. This works fine in case of the equivalent iText Java class but during the port to iTextSharp unfortunately no has been added to the declaration (as of version 5.4.4). Thus, currently copying the whole strategy is still necessary for iTextSharp.\n\n@Bruno You might want to tell the iText -> iTextSharp porting team about this.\n\nWhile you can fine tune text extraction at these code locations you should be aware that you will not find a 100% criterion here. Some reasons are:\n• Gaps between words in densely set text can be smaller than kerning or other gaps for some optical effect inside words. Thus, there is no one-size-fits-all factor here.\n• In PDFs not using the space character at all (as you can always use gaps, this is possible), the \"width of a space character\" might be some random value or not determinable at all!\n• There are funny PDFs abusing the space character width (which can individually be stretched at any time for the operations to follow) to do some tabular formatting while using gaps for word breaking. In such a PDF the value of the current width of a space character cannot seriously be used to determine word breaks.\n• Sometimes you find s i n g l e words in a line printed spaced out for emphasis. These will likely be parsed as a collection of one-letter words by most heuristics.\n\nYou can get better than the iText heuristics and those derived from it using other constants by taking into account the actual visual free space between all characters (using PDF rendering or font information analysis mechanisms), but for a perceivable improvement you have to invest much time."
    },
    {
        "link": "https://vbforums.com/showthread.php?870051-RESOLVED-Selecting-area-of-pdf-to-use-for-text-extraction",
        "document": "\n• Re: Selecting area of pdf to use for text extraction Hi,\n\n \n\n here a sample with iTextSharp and RegEx to extract the Emails from a Pdf\n\n I used a Richtextbox to display the Pdf\n\n \n\n see Image, the Emails are in the textbox\n\n \n\n \n\n here the Code\n\n Public Class Form1 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click 'RichTextBox1.Text = GetTextFromPDF(\"E:\\CDO.pdf\") GetTextFromPDF(\"E:\\CDO.pdf\") End Sub Public Function GetTextFromPDF(ByVal PdfFileName As String) As String Dim oReader As New iTextSharp.text.pdf.PdfReader(PdfFileName) Dim sOut = \"\" For i = 1 To oReader.NumberOfPages Dim its As New iTextSharp.text.pdf.parser.SimpleTextExtractionStrategy sOut &= iTextSharp.text.pdf.parser.PdfTextExtractor.GetTextFromPage(oReader, i, its) Dim adrRx As Regex = New Regex(\"\\b[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}\\b\") Dim emails As New List(Of String) For Each item As Match In adrRx.Matches(sOut.ToLower) emails.Add(item.Value) Next Dim emailsString As String = Join(emails.Distinct.ToArray, \"; \") TextBox1.Text = emailsString Next Return sOut End Function HTH to hunt a species to extinction is not logical ! \n\n since 2010 the number of Tigers are rising again in 2016 - 3900 were counted. with Baby Callas it's 3901, my wife and I had 2-3 months the privilege of raising a Baby Tiger .\n• Re: Selecting area of pdf to use for text extraction Hi,\n\n \n\n have you tried to load this to a Richtextbox ?\n\n \n\n EDIT: see if this will return mr a\n\n I changed the Regex to search for and return the next Word, in this case \n\n \n\n Public Function GetTextFromPDF(ByVal PdfFileName As String) As String Dim oReader As New iTextSharp.text.pdf.PdfReader(PdfFileName) Dim sOut = \"\" For i = 1 To oReader.NumberOfPages Dim its As New iTextSharp.text.pdf.parser.SimpleTextExtractionStrategy sOut &= iTextSharp.text.pdf.parser.PdfTextExtractor.GetTextFromPage(oReader, i, its) 'Dim adrRx As Regex = New Regex(\"\\b[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}\\b\") Dim adrRx As Regex = New Regex(\" \\s(\\w+)\") Dim emails As New List(Of String) For Each item As Match In adrRx.Matches(sOut.ToLower) emails.Add(item.Value) Next Dim emailsString As String = Join(emails.Distinct.ToArray, \"; \") TextBox1.Text = emailsString Next Return sOut End Function Last edited by ChrisE; Jan 10th, 2019 at . to hunt a species to extinction is not logical ! \n\n since 2010 the number of Tigers are rising again in 2016 - 3900 were counted. with Baby Callas it's 3901, my wife and I had 2-3 months the privilege of raising a Baby Tiger .\n• Re: Selecting area of pdf to use for text extraction Hi,\n\n \n\n I think you should extract the Text with a delimiter\n\n then you can search for Mr / Mrs.\n\n It will just depend if the address is...some Text...Mr;A;Smith;etcc.. one after another\n\n \n\n this will extract the Text\n\n Private Sub Button4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button4.Click GetTextFromPDF(\"E:\\CDO.pdf\") End Sub Public Function GetTextFromPDF2(ByVal PdfFileName As String) As String Dim oReader As New iTextSharp.text.pdf.PdfReader(PdfFileName) Dim sOut = \"\" For i = 1 To oReader.NumberOfPages Dim its As New iTextSharp.text.pdf.parser.SimpleTextExtractionStrategy sOut &= iTextSharp.text.pdf.parser.PdfTextExtractor.GetTextFromPage(oReader, i, its) Dim adrRx As Regex = New Regex(\"(\\b[\\w-_]+\\b)\") Dim emails As New List(Of String) For Each item As Match In adrRx.Matches(sOut.ToLower) emails.Add(item.Value) Next Dim emailsString As String = Join(emails.Distinct.ToArray, \";\") TextBox1.Text = emailsString Next Return sOut End Function just a thought\n\n \n\n EDIT:\n\n or play around with getting the next words\n\n \n\n si gave the clue\n\n Is it always the same text before it, and the same text after it?\n\n \n\n If so you could just grab the text from between them. si gave the clueIs it always the same text before it, and the same text after it?If so you could just grab the text from between them. this will return the next words after Last edited by ChrisE; Jan 10th, 2019 at . to hunt a species to extinction is not logical ! \n\n since 2010 the number of Tigers are rising again in 2016 - 3900 were counted. with Baby Callas it's 3901, my wife and I had 2-3 months the privilege of raising a Baby Tiger .\n• Re: Selecting area of pdf to use for text extraction \n\n \n\n you say the Address is always in the same postion, perhaps the Address then has always the sam Index ?\n\n \n\n try out a few of the Pdf's that you have, see change in Code from Post#4\n\n \n\n Dim adrRx As Regex = New Regex(\"mr\\s(\\w+)\") Dim emails As New List(Of String) For Each item As Match In adrRx.Matches(sOut.ToLower) emails.Add( ) Next Dim emailsString As String = Join(emails.Distinct.ToArray, \"; \") TextBox1.Text = emailsString this will search for Mr and return the Index, you will have to try a few Pdf's, if your lucky they will\n\n all start with the same Index\n\n \n\n EDIT: of course change Mr to whatever is in the other Address \"John Doe\", so search for John Hi,you say the Address is always in the same postion, perhaps the Address then has always the sam Index ?try out a few of the Pdf's that you have, see change in Code from Post#4this will search for Mr and return the Index, you will have to try a few Pdf's, if your lucky they willall start with the same IndexEDIT: of course change Mr to whatever is in the other Address \"John Doe\", so search for John \n\n I tried this on a pdf and the first position is 0, but that only works for the first page of the pdf with an address. I get this in the text box:\n\n \n\n 0 mr donald; 59 mr nathan; 117 mr anthony; 179 mr richard; 301 mr timothy; 592 mr gavin; 825 mr john; 1050 mr james;\n\n \n\n I used: ... so I could see the text value and the index number\n\n \n\n The 'gaps' in index are where you get a Mrs, so this is working OK. However, trying it on another pdf gives:\n\n \n\n 1041 mr james; 6951 mr jacob; 8145 mr david; 11740 mr alexandru; 16465 mr sheikh; 18836 mr matthew\n\n \n\n The pdfs I'm working with using are usually combined files of other pdfs with different background designs, so this may explain the odd numbers.\n\n \n\n This test has also highlighted issues in some of the records beginning with Miss, Mrs, Ms, Dr or whatever - others have just Christian Name Others still have a generic title such as 'The Householder'. I don't think I would be able to account for every possibility 100% of the time.\n\n \n\n I also tried this process with a particularly bloated pdf - this file is what prompted me to seek an alternative to cropping the file and extracting the address from there with pdftotext in the first place. This file still took an age to run - I had to abort the program in the end - so I'm now thinking that if I'm still going to have problems with some files, I might as well stick to the pdftotext program!"
    },
    {
        "link": "https://ironpdf.com/blog/compare-to-other-components/extract-text-from-pdf-csharp-itextsharp",
        "document": "Test in production without watermarks.\n\nWorks wherever you need it to."
    },
    {
        "link": "https://vbforums.com/showthread.php?702419-Itextsharp-search-word-in-multiple-PDF-then-isolate-the-PDF-document",
        "document": "\n• None Itextsharp search word in multiple PDF then isolate the PDF document Thread: Itextsharp search word in multiple PDF then isolate the PDF document\n• Itextsharp search word in multiple PDF then isolate the PDF document My first post. I already used itextsharp pdfreader to find a word in multiple PDF documents. Now I want to copy the PDF that contains the word into a new PDF. How can I download Manipulatepdf2.vb? I think the class includes method to accomplish what I am trying to do. Thank you all.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document From what you wrote, it seems like you want to merge 2 or more pdf documents into a single pdf. To do this, you can use either the MergePdfFiles or MergePdfFilesWithBookmarks method found in PdfManipulation2 class. You can download that class here:\n\n http://www.vbforums.com/showthread.p...ing-iTextSharp Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Actually I do not want to merge. I found and downloaded PdfManipulation2 class. So what I want is this. I used pdfreader to search for a word in a mutiple pdf document in other words the document contains all kinds of individual pdfs. pages range from 1 to 3. Now let's say I searched for \"Dave Jones\". I found it on page 5! How do I get the page number or document to PdfManipulation2.ExtractPdfPage(\"sss.pdf\",pagenumber,outputpdf) ? Thank you.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document I tried this from your prior post but not working. Thank you.\n\n \n\n 'Specified the path to the source pdf file\n\n Dim sourcePdf as sgtring = \"C:\\Documents and Settings\\rch\\Desktop\\psm2010\\venteps\\out\\table40.pdf\"\n\n \n\n 'Extract page # 2 off this above pdf file\n\n Dim pageNumberToExtract As Integer = 2\n\n \n\n 'And then save it to a new pdf named 'table40_page2.pdf'\n\n Dim outputPdf As String = \"C:\\Documents and Settings\\rch\\Desktop\\psm2010\\venteps\\out\\table40_page2.pdf\"\n\n \n\n 'Call the sub somewhere in your program passing in the above arguments\n\n PdfManipulation.ExtractPdfPage(\"C:\\Documents and Settings\\rch\\Desktop\\psm2010\\venteps\\out\\table40.pdf\", pageNumberToExtract, outputPdf)\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document 1. To know on which page your search term was found, you need to search for it page by page. That is, run a loop thru the pdf pages and for each pdf page, you do the search. If found, you mark that page number (i.e adding it to a list) for later use. Once you get out of the loop, you check in your found list to see if anything in there. If there is, you loop thru the list and extract the pages.\n\n 2. \"It's not working\" isn't very informative. It's like going to a doctor and say \"I'm sick\" without any detailed descriptions of the symptoms... You need to tell me what happened and/or what didn't happened when you run that code. Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Stanav, thank you much for your help. I think I put the error message on a different post. The message was \"the item has already being created\" the copypdf line creates the file and the addpage(page) line was choking.\n\n \n\n Please check this post.\n\n http://www.vbforums.com/showthread.p...textsharp+page\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Try to use a different output name or delete the existing one. You can't have 2 files with the same name in same directory. Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document I have the search word \"Hello\" on page 15 of a 30 page pdf document which is made up of 10 separate pdf documents. When I run this function, it finds the word after the first read when i=1 and sets sOut=\"Hello and the rest of the information on the page\". What I am doing wrong.\n\n \n\n BTW I also have input directory and output directory with different file names.\n\n \n\n Public Shared Function GetTextFromPDF(PdfFileName As String) As String\n\n Dim oReader As New iTextSharp.text.pdf.PdfReader(PdfFileName)\n\n Dim sOut As String\n\n Dim _pageNumber As Integer\n\n Dim i As Integer\n\n sOut = Hello\"\n\n Dim x As Integer = 1\n\n For i = 1 To oReader.NumberOfPages\n\n Dim its As New iTextSharp.text.pdf.parser.SimpleTextExtractionStrategy\n\n sOut &= iTextSharp.text.pdf.parser.PdfTextExtractor.GetTextFromPage(oReader, i, its)\n\n Next\n\n Return sOut\n\n End Function\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Try something like this:\n• None ''' Simple page by page text search a PDF file and return a list of the page numbers where a match was found.\n• None ''' <param name=\"sourcePdf\">the full path to the pdf file to be searched</param>\n• None ''' <returns>List(Of Integer) containing the page number whose page contains one or more match string</returns>\n• None Public Shared Function SearchTextFromPdf(ByVal sourcePdf As String, ByVal searchPhrase As String, Optional ByVal caseSensitive As Boolean = False) As List(Of Integer)\n• None For i As Integer = 1 To reader.NumberOfPages() After you've got the list of the page numbers where the search matched, simply loop thru it and call ExtractPdfPage method of PdfManipulation2 class. Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Thanks for this code however I still the get the error in pdfmanipulation2.ExtractPdfPage \"An item with the same key has already been added.\" \n\n \n\n pdfCpy = New iTextSharp.text.pdf.PdfCopy(doc, New IO.FileStream(outPdf, IO.FileMode.Create))\n\n doc.Open()\n\n page = pdfCpy.GetImportedPage(reader, pageNumberToExtract)\n\n pdfCpy.AddPage(page) ----ERROR occurs here.\n\n \n\n Thank you.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hey Stanav, Please shed some light on how to retrieve a 3-page PDF from multiple PDFs PDF file? I search for word, I find the word on page 5 but page 5 is the first page of a 3-page PDF and I want to retrieve all 3 pages into output folder. Currently, I have combines methods from PDFmanipulation2 but its become a mess. Thanks for your help.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document How can you tell how many pages to grab after each search match? There has to be a rule of some sort. Computers are not human, and if the commands/rules aren't clear, they can't be executed reliably.\n\n As for achieving the task you are working on, I've given you all the relevant code needed to get it done. It's now just a matter of using it - modify it when necessary - to make it work the way you want. Programming is a lot more than copying and pasting.\n\n In order for me to provide further help, you need to:\n\n 1. Upload a sample pdf file that I can use to test with\n\n 2. State clearly what you want to do with the pdf\n\n 3. State any rules/patterns that must be obeyed...\n\n \n\n I don't promise anything, but if I can spare some time, I'll give it a try. Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hey Stanav, have no fear. Thank you for the help. I figured out how to accomplish what I want but I still have that annoying error.\n\n \n\n pdfCpy = New iTextSharp.text.pdf.PdfCopy(doc, New IO.FileStream(outPdf, IO.FileMode.Create))\n\n doc.Open()\n\n page = pdfCpy.GetImportedPage(reader, pageNumberToExtract)\n\n pdfCpy.AddPage(page) ----ERROR occurs here.\n\n \n\n Please advice on what is wrong here and I will take it from there.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document I can't tell you what's wrong until I have a chance to examine it myself. And that's the reason why I asked you upload a test file and provide me the necessary info to do the test. The line you pointed out where the error occurred is entirely within iTextSharp code, and therefore I'm suspecting that you do something wrong in your code rather than iTextSharp's bug. Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Due to constraints of the contents of the data, I cannot send actual stuff but this is what I am doing. Thanks for your patience.\n\n \n\n I call this function with the supplied parameters\n\n \n\n PdfManipulation2.ExtractPdfPage(\"c:\\documents\\xyz.PDF\", 22, \"c:\\single_XYZPdf\\single.PDF\")\n\n \"c:\\documents\\xyz.PDF\" --contains 30 customer letters(each 3 pages long)\n\n \"c:\\single_XYZPdf\\single.PDF\" -- will contain page 22. ** I will write code to loop from page 22 for 3 pages to output to single_PDF\n\n \n\n This code is from PdfManipulation2.ExtractPdfPage\n\n pdfCpy = New iTextSharp.text.pdf.PdfCopy(doc, New IO.FileStream(outPdf, IO.FileMode.Create)) --This line is creating the PDF.\n\n doc.Open()\n\n page = pdfCpy.GetImportedPage(reader, pageNumberToExtract)\n\n pdfCpy.AddPage(page) ----ERROR occurs here.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document As far as I see, I can't replicate the error... The code works as intended each and very time I run it. For testing purpose, use a different pdf file and extract a random page from it. Does that work? Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hello Stanav, I tried with the attached PDF .\n\n \n\n Private Sub btnSearch_Click(sender As System.Object, e As System.EventArgs) Handles btnSearch.Click\n\n Dim sourcepdf As String = \"C:\\HH\\diabeteslbs.pdf\"\n\n PdfManipulation2.ExtractPdfPage(sourcepdf, 4, \"c:\\HO\\Page_4.pdf\")\n\n MessageBox.Show(\"Done!\")\n\n I still got message \"An item with the same key has already been added.\"\n\n Thanks for your help.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document I still can't replicate the error using the sample file you uploaded. It's has to be something in your project or the PdfManipulation2.ExtractPdfPage code has been modified.\n\n Can you compare the code you have with this one? If yours is different than you know why it didn't work, right.\n\n Public Overloads Shared Sub ExtractPdfPage(ByVal sourcePdf As String, ByVal pageNumberToExtract As Integer, ByVal outPdf As String) Dim reader As iTextSharp.text.pdf.PdfReader = Nothing Dim doc As iTextSharp.text.Document = Nothing Dim pdfCpy As iTextSharp.text.pdf.PdfCopy = Nothing Dim page As iTextSharp.text.pdf.PdfImportedPage = Nothing Try reader = New iTextSharp.text.pdf.PdfReader(sourcePdf) doc = New iTextSharp.text.Document(reader.GetPageSizeWithRotation(1)) pdfCpy = New iTextSharp.text.pdf.PdfCopy(doc, New IO.FileStream(outPdf, IO.FileMode.Create)) doc.Open() page = pdfCpy.GetImportedPage(reader, pageNumberToExtract) pdfCpy.AddPage(page) doc.Close() reader.Close() Catch ex As Exception Throw ex End Try End Sub Alternately, you can re-download the PdfManipulation2 class and start a fresh project to test the function. If it works, and I'm pretty sure that it will, you have your conclusion... Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hey Stanav, Please advice on the difference between the two snippets. I re-downloaded the pdfmanipulation2.vb. You can see the \"Throw Ex\" happened when I ran the code again.\n\n \n\n Thank you\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Please check this attachment and you can see the error message. Thank you\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document The 2 code snippets are the same, except the 3 lines that are commented out which is OK. I have no idea why you keep getting that error while I don't... Are you using the right version of iTextSharp? It should be 5.2.1.0 or newer.\n\n For testing purposes, can you start a new project and test the function again? Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hello again, I am on Windows 7 and using itextsharp-all-5.3.4 in a brand new VS2010 Windows From project.\n\n Thank you\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Ah... The new itextsharp version 5.3.4 seems to be the culprit. I tested using that new version and sure enough, I got the same error as you did.\n\n Use this 5.2.1 version below and you should be good to go....\n\n https://dl.dropbox.com/u/20581085/itextsharp_5.2.1.zip Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Okay, I knew you were smarter than me. Thank you for sticking with me.\n\n Now I am going back to my original project which is \n\n 1. search a pdf document for a word(label). \n\n 2. Once found, select the page number as starting page and select all the pages that contain the label into a separate pdf.\n\n For example.\n\n I have a 30 page pdf that actually contain 10 customer invoices. Each invoice has a unique label. I search for label \"Rome34\". When I find it, I want to select all the pages that have \"Rome34\" to create a separate pdf.\n\n \n\n Thanks again.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Copy and paste this function to the PdfManipulation2 class\n\n Public Shared Function FindAndExtract(ByVal sourcePdf As String, ByVal outPdf As String, ByVal searchPhrase As String, Optional ByVal caseSensitive As Boolean = False) As Boolean Dim result As Boolean = False Dim raf As iTextSharp.text.pdf.RandomAccessFileOrArray = Nothing Dim reader As iTextSharp.text.pdf.PdfReader = Nothing Dim doc As iTextSharp.text.Document = Nothing Dim pdfCpy As iTextSharp.text.pdf.PdfCopy = Nothing Dim page As iTextSharp.text.pdf.PdfImportedPage = Nothing Try raf = New iTextSharp.text.pdf.RandomAccessFileOrArray(sourcePdf) reader = New iTextSharp.text.pdf.PdfReader(raf, Nothing) If caseSensitive = False Then searchPhrase = searchPhrase.ToLower() End If For i As Integer = 1 To reader.NumberOfPages() Dim pageText As String = iTextSharp.text.pdf.parser.PdfTextExtractor.GetTextFromPage(reader, i) If caseSensitive = False Then pageText = pageText.ToLower() End If If pageText.Contains(searchPhrase) Then If doc Is Nothing Then doc = New iTextSharp.text.Document(reader.GetPageSizeWithRotation(1)) pdfCpy = New iTextSharp.text.pdf.PdfCopy(doc, New IO.FileStream(outPdf, IO.FileMode.Create)) doc.Open() End If page = pdfCpy.GetImportedPage(reader, i) pdfCpy.AddPage(page) End If Next If doc IsNot Nothing Then doc.Close() result = True End If reader.Close() Catch ex As Exception Throw ex End Try Return result End Function Usage example:\n\n Private Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click Dim searchText As String = \"4 oz. regular soda\" Dim result As Boolean = PdfManipulation2.FindAndExtract(\"d:\\test1.pdf\", \"d:\\test1_extracted.pdf\", searchText) MessageBox.Show(result.ToString) End Sub Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hey Stanav, you did it! Now I have exactly what I was looking for in guidance and solution. Thanks again for the help and Happy Holidays.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hey Stanav, I have folder X with 20 PDF files. I want to merge them into one PDF and output to folder Y.\n\n Can I use the wildcat *pdf with the sourceTable\" ? Instead of me stringing all the PDF file names as an array?\n\n pdfManipulation.ExtractAndMergePdfPages(SourceTable, outPdf)\n\n Thanks\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hey Stanav, I have folder X with 20 PDF files. I want to merge them into one PDF and output to folder Y.\n\n Can I use the wildcat *pdf with the sourceTable\" ? Instead of me stringing all the PDF file names as an array?\n\n pdfManipulation.ExtractAndMergePdfPages(SourceTable, outPdf)\n\n Thanks You need to use this method:\n\n 'Merge multiple pdfs into a single one. Public Shared Function MergePdfFiles(ByVal pdfFiles() As String, ByVal outputPath As String, _ Optional ByVal authorName As String = \"\", _ Optional ByVal creatorName As String = \"\", _ Optional ByVal subject As String = \"\", _ Optional ByVal title As String = \"\", _ Optional ByVal keywords As String = \"\") As Boolean As you see in the function signature, it takes an array of pdf files and then merge to a single outpdf file. And yes, you can use system.io.directory.GetFiles(folderPath, \"*.pdf\") to get the pdf files and feed that array to the function.\n\n The method that you mentioned pdfManipulation.ExtractAndMergePdfPages(SourceTable, outPdf) is for extract some pages from each pdf and merge them to 1 single pdf. For example, take pages 1, 3, 7 from A.pdf, pages 9, 11, 30 from B.pdf. pages 2, 8, 11 from C.pdf and merge them into a new pdf. As you can see, since the parameters are pretty complex, it's easier to build a datatable to feed the function. However, you don't have to worry about this method since the MergePdfFiles will do exactly what you need. Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Oops! I meant it worked beautifully. I have a question. How fast do you think the method to Extract PDF will retrieve a Tagged PDF(meaning a unique identifier) from one million page PDF? Do you also know any disk size calculation for one million pages of a PDF document?\n\n \n\n Thanks\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document I haven't work with any tagged pdf so I can't be sure on this, but it you're asking about using the FindAndExtract method above, I'd say it won't make much difference compared to non-tagged pdf's. The whole 1 mil pages are still being looped through 1 by 1. As for how long it'll take to complete a 1 mil page pdf, you're going to try and time it yourself. I don't have anything that large. The largest pdf file I've ever worked on was around 30k pages, and iTextSharp handled it without any problems.\n\n How much disk size a 1 mil page pdf takes? It's a tricky question because there are way too many variables involved in creating a pdf page: images, embedded resources, layers... just to name a few. And no, I don't know of anyway you can calculate or estimate the final disk size of a pdf before it is created. Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hi Stanav, hope you are well. I am using Pdfmanipulation2. Everything is fine. I just want to know how to position the bookmark (the BLUE font) from top of page to bottom preferably (footer section)during merging. I don't want to replace the current footer but insert the bookmark at the bottom two line footer. If that is too difficult then to the end of document before the footer. Thanks\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hi Stanav, hope you are well. I am using Pdfmanipulation2. Everything is fine. I just want to know how to position the bookmark (the BLUE font) from top of page to bottom preferably (footer section)during merging. I don't want to replace the current footer but insert the bookmark at the bottom two line footer. If that is too difficult then to the end of document before the footer. Thanks You see in the code how a paragraph is added to every page 1 of a pdf file before the original pdf page is copied over. That paragraph is what makes the bookmark. If you want the bookmark to be at the bottom of the page, just add the paragraph after you add the copied page to the new document. That is, change the inner while loop to this:\n\n While i < pageCount i += 1 'Get the input page size pdfDoc.SetPageSize(reader.GetPageSizeWithRotation(i)) 'Create a new page on the output document pdfDoc.NewPage() 'Now we get the imported page page = writer.GetImportedPage(reader, i) 'Read the imported page's rotation rotation = reader.GetPageRotation(i) 'Then add the imported page to the PdfContentByte object as a template based on the page's rotation If rotation = 90 Then cb.AddTemplate(page, 0, -1.0F, 1.0F, 0, 0, reader.GetPageSizeWithRotation(i).Height) ElseIf rotation = 270 Then cb.AddTemplate(page, 0, 1.0F, -1.0F, 0, reader.GetPageSizeWithRotation(i).Width + 60, -30) Else cb.AddTemplate(page, 1.0F, 0, 0, 1.0F, 0, 0) End If 'If it is the 1st page, we add bookmarks to the page If i = 1 Then 'First create a paragraph using the filename as the heading Dim para As New iTextSharp.text.Paragraph(IO.Path.GetFileName(fileName).ToUpper(), bookmarkFont) 'Then create a chapter from the above paragraph Dim chpter As New iTextSharp.text.Chapter(para, f + 1) 'Finally add the chapter to the document pdfDoc.Add(chpter) End If End While Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hey Stanav, I 'm back. I hope all is well with you.\n\n Issue I got all the pdfs in a folder. The question is how to programmatically(VB.NET) open folder and print all the pdfs stored as individual documents.\n\n \n\n Thank you.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document You would get a list of all the pdf files in that folder and then loop through the list printing 1 at a time. \n\n 1. To get the pdfs in a folder, you can use System.IO.Directory.GetFiles method.\n\n 2. To print a pdf file using the default application and printer, you start a process, set the verb to \"print\" and pass in the filepath as the argument. Search the forum and you will find examples. Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hello Stanav,\n\n I am trying to shrink the sizes pdf files in a folder. Basically compress each page by 80% or more without affecting the contents . I checked out the ResizePage function in the PDFManipulation2 but I am not sure it will do I need. Ideally, I would like to set the dpi to 72 and reduce the pixel count. Any ideas will be appreciated.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hello Stanav,\n\n \n\n I have just downloaded your PdfManipulation2 and it is great. However in the functions that use \"token = New iTextSharp.text.pdf.PRTokeniser(pageBytes)\" I get:\n\n Error 1 Value of type '1-dimensional array of Byte' cannot be converted to 'iTextSharp.text.pdf.RandomAccessFileOrArray'.\n\n \n\n Also getting these warnings:\n\n Warning 2 'Public Sub New(raf As iTextSharp.text.pdf.RandomAccessFileOrArray, ownerPassword() As Byte)' is obsolete: 'Use the constructor that takes a RandomAccessFileOrArray'. \n\n \n\n Am I doing something wrong? I am using \"VB Express 2012\"\n\n Thanks for your help\n\n Brad\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hello Stanav,\n\n \n\n I have just downloaded your PdfManipulation2 and it is great. However in the functions that use \"token = New iTextSharp.text.pdf.PRTokeniser(pageBytes)\" I get:\n\n Error 1 Value of type '1-dimensional array of Byte' cannot be converted to 'iTextSharp.text.pdf.RandomAccessFileOrArray'.\n\n \n\n Also getting these warnings:\n\n Warning 2 'Public Sub New(raf As iTextSharp.text.pdf.RandomAccessFileOrArray, ownerPassword() As Byte)' is obsolete: 'Use the constructor that takes a RandomAccessFileOrArray'. \n\n \n\n Am I doing something wrong? I am using \"VB Express 2012\"\n\n Thanks for your help\n\n Brad iTextSharp has evolved quite a bit since the last version that I worked on... So to answer your question, I'd need to know 2 things:\n\n 1. What version of iTextSharp are you using?\n\n 2. What exactly is it that you're trying to do?\n\n \n\n I've been extremely busy and also since I haven't had a need to use newer versions of iTextSharp, it's unlikely that I will update PdfManipulation2 class any time soon. If you're using a iTextSharp version newer than 5.2.1, I'd suggest you to download 5.2.1 and try again. Most of the time it will resolve the issues. Let us have faith that right makes might, and in that faith, let us, to the end, dare to do our duty as we understand it.\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document\n• Re: Itextsharp search word in multiple PDF then isolate the PDF document Hello Stanav,\n\n I am back after search all of PDFManipulation2. Here is the situation. Every time I convert MS Word 2007 to PDF, The PDF is shrunk to about 90% of the Word document. Is there anyway to send printer commands to keep pdf 100%?\n\n Thank you.\n• None Itextsharp search word in multiple PDF then isolate the PDF document\n• You may not post new threads\n• You may not post replies\n• You may not post attachments\n• You may not edit your posts\n\n\n\n \n\n \n\n Click Here to Expand Forum to Full Width"
    }
]